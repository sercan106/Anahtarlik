{% extends "ana.html" %}
{% load static %}

{% block title %}PetShop Paneli - PetSafe Hub{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Hero Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="hero-section bg-gradient-primary text-white rounded-3 p-4 mb-4" style="background: linear-gradient(135deg, #5B9BD5 0%, #70C1B3 100%);">
                <div class="row align-items-center">
                    <div class="col-12">
                        <h2 class="mb-2"><i class="fas fa-store me-2"></i>PetShop Paneli</h2>
                        <p class="mb-0 opacity-75">Merhaba, <strong>{{ petshop.ad|default:request.user.username }}</strong> - Evcil hayvan sahiplerine hizmet verin</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- İstatistik Kartları -->
    <div class="row g-4 mb-5">
      <div class="col-lg-3 col-md-6">
        <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #5B9BD5 0%, #70C1B3 100%);">
          <div class="card-body text-center text-white">
            <div class="d-flex justify-content-center mb-3">
              <div class="bg-white bg-opacity-20 rounded-circle p-3">
                <i class="fas fa-tags fa-2x"></i>
              </div>
            </div>
            <h6 class="card-title text-white-50 mb-2">Tahsis Edilen Etiketler</h6>
            <h2 class="mb-0 fw-bold">{{ tahsis_sayisi }}</h2>
            <small class="text-white-50">Toplam tahsis</small>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #FF8C42 0%, #F2C94C 100%);">
          <div class="card-body text-center text-white">
            <div class="d-flex justify-content-center mb-3">
              <div class="bg-white bg-opacity-20 rounded-circle p-3">
                <i class="fas fa-chart-line fa-2x"></i>
              </div>
            </div>
            <h6 class="card-title text-white-50 mb-2">Satılan Etiketler</h6>
            <h2 class="mb-0 fw-bold">{{ satis_sayisi }}</h2>
            <small class="text-white-50">Aktif satış</small>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #70C1B3 0%, #6FCF97 100%);">
          <div class="card-body text-center text-white">
            <div class="d-flex justify-content-center mb-3">
              <div class="bg-white bg-opacity-20 rounded-circle p-3">
                <i class="fas fa-warehouse fa-2x"></i>
              </div>
            </div>
            <h6 class="card-title text-white-50 mb-2">Kalan Envanter</h6>
            <h2 class="mb-0 fw-bold">{{ kalan_envanter }}</h2>
            <small class="text-white-50">Stokta mevcut</small>
          </div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="card border-0 shadow-lg h-100" style="background: linear-gradient(135deg, #6FCF97 0%, #70C1B3 100%);">
          <div class="card-body text-center text-white">
            <div class="d-flex justify-content-center mb-3">
              <div class="bg-white bg-opacity-20 rounded-circle p-3">
                <i class="fas fa-coins fa-2x"></i>
              </div>
            </div>
            <h6 class="card-title text-white-50 mb-2">Kredi Bakiyem</h6>
            <h2 class="mb-0 fw-bold">{{ kredi_bakiye }}</h2>
            <small class="text-white-50">{{ petshop.satis_basari_seviyesi }}</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Sipariş Ver Kartı -->
    <div class="row g-4 mb-5">
      <div class="col-12">
        <div class="card border-0 shadow-lg position-relative overflow-hidden" style="background: linear-gradient(135deg, #2C5F8D 0%, #5B9BD5 100%);">
          <!-- Floating Elements -->
          <div class="position-absolute top-0 end-0" style="transform: translate(30px, -30px);">
            <div class="bg-white bg-opacity-10 rounded-circle" style="width: 80px; height: 80px;"></div>
          </div>
          <div class="position-absolute bottom-0 start-0" style="transform: translate(-20px, 20px);">
            <div class="bg-white bg-opacity-5 rounded-circle" style="width: 60px; height: 60px;"></div>
          </div>
          
          <div class="card-body text-center text-white p-5 position-relative">
            <!-- Minimalist Icon -->
            <div class="mb-4">
              <div class="bg-white bg-opacity-15 rounded-circle p-3 d-inline-block" style="width: 80px; height: 80px; display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-plus fa-2x"></i>
              </div>
            </div>
            
            <!-- Clean Typography -->
            <h4 class="mb-3 fw-bold">Yeni Etiket Siparişi</h4>
            <p class="mb-4 opacity-90">Müşterilerinize satmak için etiket siparişi oluşturun</p>
            
            <!-- Prominent CTA Button -->
            <a href="{% url 'shop:etiket_list' %}" 
               class="btn btn-light btn-lg px-5 py-3 fw-bold text-primary shadow-sm border-0 rounded-pill"
               style="background: rgba(255,255,255,0.95); transition: all 0.3s ease; text-decoration: none;"
               onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.15)'"
               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0,0,0,0.1)'">
              <i class="fas fa-shopping-cart me-2"></i>
              Etiket Ürünleri
            </a>
          </div>
        </div>
      </div>
    </div>


    <!-- Etiket Yönetimi Bölümü -->
    <div class="row g-4 mb-5">
      <div class="col-lg-6">
        <div class="card border-0 shadow-lg h-100">
          <div class="card-header bg-gradient-info text-white border-0" style="background: linear-gradient(135deg, #2C5F8D 0%, #5B9BD5 100%);">
            <div class="d-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center">
                <div class="bg-white bg-opacity-20 rounded-circle p-2 me-3">
                  <i class="fas fa-tags"></i>
                </div>
                <div>
                  <h6 class="mb-0">Tahsis Edilen Etiketler</h6>
                  <small class="opacity-75">Size tahsis edilen etiketler</small>
                </div>
              </div>
              <a href="{% url 'petshop:tahsis_listesi' %}" class="btn btn-light btn-sm">
                <i class="fas fa-external-link-alt me-1"></i>Hepsini Gör
              </a>
            </div>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table mb-0 table-hover">
                <thead class="table-light">
                  <tr>
                    <th class="border-0">Seri No</th>
                    <th class="border-0">Tahsis Tarihi</th>
                    <th class="border-0">Durum</th>
                  </tr>
                </thead>
                <tbody>
                {% for e in tahsis_edilenler %}
                  <tr>
                    <td class="fw-bold">{{ e.seri_numarasi }}</td>
                    <td>{{ e.tahsis_tarihi|date:"d.m.Y" }}</td>
                    <td>
                      {% if e.aktif %}
                        <span class="badge bg-success">
                          <i class="fas fa-check me-1"></i>Aktif
                        </span>
                      {% else %}
                        <span class="badge bg-warning text-dark">
                          <i class="fas fa-clock me-1"></i>Pasif
                        </span>
                      {% endif %}
                    </td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="3" class="text-center text-muted py-4">
                      <i class="fas fa-inbox fa-2x mb-2 d-block opacity-50"></i>
                      <div>Tahsis edilmiş etiket bulunmamaktadır</div>
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="card border-0 shadow-lg h-100">
          <div class="card-header bg-gradient-success text-white border-0" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
            <div class="d-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center">
                <div class="bg-white bg-opacity-20 rounded-circle p-2 me-3">
                  <i class="fas fa-chart-line"></i>
                </div>
                <div>
                  <h6 class="mb-0">Satılan / Aktif Edilen Etiketler</h6>
                  <small class="opacity-75">Evcil hayvan sahipleri tarafından aktif edilen etiketler</small>
                </div>
              </div>
              <a href="{% url 'petshop:satis_listesi' %}" class="btn btn-light btn-sm">
                <i class="fas fa-external-link-alt me-1"></i>Hepsini Gör
              </a>
            </div>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table mb-0 table-hover">
                <thead class="table-light">
                  <tr>
                    <th class="border-0">Seri No</th>
                    <th class="border-0">İlk Aktivasyon</th>
                    <th class="border-0">Son Aktifleşme</th>
                  </tr>
                </thead>
                <tbody>
                {% for e in satilanlar %}
                  <tr>
                    <td class="fw-bold">{{ e.seri_numarasi }}</td>
                    <td>{{ e.first_activated_at|date:"d.m.Y H:i" }}</td>
                    <td>{{ e.aktiflestirme_tarihi|date:"d.m.Y H:i" }}</td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="3" class="text-center text-muted py-4">
                      <i class="fas fa-chart-line fa-2x mb-2 d-block opacity-50"></i>
                      <div>Henüz satılan etiket bulunmamaktadır</div>
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sipariş Talepleri Bölümü -->
    <div class="row g-4 mb-5">
      <div class="col-12">
        <div class="card border-0 shadow-lg">
          <div class="card-header bg-gradient-warning text-white border-0" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <div class="d-flex justify-content-between align-items-center">
              <div class="d-flex align-items-center">
                <div class="bg-white bg-opacity-20 rounded-circle p-2 me-3">
                  <i class="fas fa-shopping-cart"></i>
                </div>
                <div>
                  <h6 class="mb-0">Sipariş Taleplerim</h6>
                  <small class="opacity-75">Etiket siparişlerinizin durumu</small>
                </div>
              </div>
              <a href="{% url 'petshop:siparis_listesi' %}" class="btn btn-light btn-sm">
                <i class="fas fa-external-link-alt me-1"></i>Hepsini Gör
              </a>
            </div>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table mb-0 table-hover">
                <thead class="table-light">
                  <tr>
                    <th class="border-0">Talep Edilen Adet</th>
                    <th class="border-0">Talep Tarihi</th>
                    <th class="border-0">Durum</th>
                    <th class="border-0">Adres</th>
                  </tr>
                </thead>
                <tbody>
                {% for s in siparis_istekleri %}
                  <tr>
                    <td class="fw-bold">{{ s.talep_edilen_adet }} etiket</td>
                    <td>{{ s.talep_tarihi|date:"d.m.Y" }}</td>
                    <td>
                      <div class="d-flex flex-wrap gap-1">
                        {% if s.onaylandi %}
                          <span class="badge bg-success">
                            <i class="fas fa-check me-1"></i>Onaylandı
                          </span>
                        {% else %}
                          <span class="badge bg-warning text-dark">
                            <i class="fas fa-clock me-1"></i>Beklemede
                          </span>
                        {% endif %}
                        {% if s.kargolandimi %}
                          <span class="badge bg-primary">
                            <i class="fas fa-truck me-1"></i>Kargolandı
                          </span>
                        {% endif %}
                        {% if s.numune_mi %}
                          <span class="badge bg-info text-dark">
                            <i class="fas fa-gift me-1"></i>Numune
                          </span>
                        {% endif %}
                      </div>
                    </td>
                    <td>
                      {% if s.farkli_adres_kullan %}
                        <span class="badge bg-info text-dark">
                          <i class="fas fa-map-marker-alt me-1"></i>Farklı Adres
                        </span>
                      {% else %}
                        <span class="badge bg-secondary">
                          <i class="fas fa-home me-1"></i>Kayıtlı Adres
                        </span>
                      {% endif %}
                    </td>
                  </tr>
                {% empty %}
                  <tr>
                    <td colspan="4" class="text-center text-muted py-4">
                      <i class="fas fa-shopping-cart fa-2x mb-2 d-block opacity-50"></i>
                      <div>Henüz sipariş talebiniz bulunmamaktadır</div>
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mesajlar -->
    {% if messages %}
      <div class="mt-3">
        {% for m in messages %}
          <div class="alert alert-{{ m.tags|default:'info' }} mb-2">{{ m }}</div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% endblock %}