{% extends 'ana.html' %}

{% block title %}Künyelerim - PetSafe Hub{% endblock %}

{% block css_dosyalar %}
<style>
.kunyelerim-container{min-height:60vh;padding:40px 0}
.page-header{background:linear-gradient(135deg,#5B9BD5 0%,#70C1B3 100%);padding:40px;border-radius:20px;color:#fff;margin-bottom:40px;box-shadow:0 8px 24px rgba(91,155,213,.25)}
.page-header h2{font-size:2.5rem;font-weight:700;margin:0;text-shadow:0 2px 8px rgba(0,0,0,.2)}
.add-pet-btn{background:rgba(255,255,255,.2);border:2px solid rgba(255,255,255,.4);color:#fff;padding:12px 30px;border-radius:50px;font-weight:600;transition:all .3s ease;text-decoration:none;display:inline-flex;align-items:center;gap:10px}
.add-pet-btn:hover{background:rgba(255,255,255,.3);border-color:rgba(255,255,255,.6);transform:translateY(-2px);color:#fff;text-decoration:none}
.pet-card{background:rgba(255,255,255,.95);border-radius:20px;border:1px solid rgba(255,255,255,.3);box-shadow:0 8px 24px rgba(91,155,213,.12);transition:all .3s ease;overflow:hidden;height:100%}
.pet-card:hover{transform:translateY(-8px);box-shadow:0 12px 32px rgba(91,155,213,.18)}
.pet-card-header{background:linear-gradient(135deg,#5B9BD5 0%,#70C1B3 100%);padding:20px;color:#fff}
.pet-card-header h6{margin:0;font-weight:600;font-size:1.1rem}
.badge{padding:6px 16px;border-radius:50px;font-weight:600;font-size:.85rem}
.badge.bg-success{background:#6FCF97!important}
.pet-card-body{padding:25px}
.card-title{font-weight:700;font-size:1.3rem;margin-bottom:15px}
.info-item{display:flex;align-items:center;margin-bottom:12px;font-size:.95rem}
.info-item i{width:25px;color:#5B9BD5;margin-right:8px}
.pet-card-footer{padding:20px;background:rgba(247,249,252,.5);border-top:1px solid rgba(0,0,0,.05)}
.btn-sm{padding:8px 20px;border-radius:50px;font-weight:600;font-size:.85rem;transition:all .3s ease}
.btn-outline-primary{border:2px solid #5B9BD5;color:#5B9BD5}
.btn-outline-primary:hover{background:#5B9BD5;color:#fff;transform:translateY(-2px)}
.btn-outline-success{border:2px solid #6FCF97;color:#6FCF97}
.btn-outline-success:hover{background:#6FCF97;color:#fff;transform:translateY(-2px)}
.btn-warning{background:#F2C94C;color:#2d3436;border:none}
.btn-warning:hover{background:#e0b73e;transform:translateY(-2px)}
.empty-state{text-align:center;padding:80px 40px;background:rgba(255,255,255,.8);border-radius:20px}
.empty-state i{font-size:5rem;color:#b2bec3;margin-bottom:20px;opacity:.5}
.btn-primary{background:linear-gradient(135deg,#5B9BD5 0%,#70C1B3 100%);border:none;padding:14px 35px;border-radius:50px;font-weight:600;transition:all .3s ease;box-shadow:0 6px 20px rgba(91,155,213,.3)}
.btn-primary:hover{transform:translateY(-3px);box-shadow:0 10px 30px rgba(91,155,213,.4)}
@media(max-width:768px){.page-header{padding:30px 20px;text-align:center}.page-header h2{font-size:1.8rem;margin-bottom:15px}.add-pet-btn{width:100%;justify-content:center}}
</style>
{% endblock %}

{% block content %}
<div class="kunyelerim-container">
    <div class="container">
        <div class="page-header">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h2><i class="fas fa-qrcode me-3"></i>Künyelerim</h2>
                </div>
                <div class="col-md-4 text-md-end mt-3 mt-md-0">
                    <a href="{% url 'anahtarlik:add_pet' %}" class="add-pet-btn">
                        <i class="fas fa-plus"></i>Yeni Evcil Hayvan Ekle
                    </a>
                </div>
            </div>
        </div>

        {% if etiketler %}
            <div class="row">
                {% for etiket in etiketler %}
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="pet-card">
                        <div class="pet-card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <h6><i class="fas fa-tag me-2"></i>{{ etiket.seri_numarasi }}</h6>
                                {% if etiket.aktif %}
                                    <span class="badge bg-success">Aktif</span>
                                {% else %}
                                    <span class="badge bg-secondary">Pasif</span>
                                {% endif %}
                            </div>
                        </div>
                        <div class="pet-card-body">
                            {% if etiket.evcil_hayvan %}
                                <h6 class="card-title">{{ etiket.evcil_hayvan.ad }}</h6>
                                <div class="info-item">
                                    <i class="fas fa-paw"></i>
                                    <span>{{ etiket.evcil_hayvan.tur.ad }}{% if etiket.evcil_hayvan.irk %} - {{ etiket.evcil_hayvan.irk.ad }}{% endif %}</span>
                                </div>
                                <div class="info-item">
                                    <i class="fas fa-calendar"></i>
                                    <span>Oluşturulma: {{ etiket.olusturulma_tarihi|date:"d.m.Y" }}</span>
                                </div>
                                {% if etiket.aktiflestirme_tarihi %}
                                <div class="info-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Aktivasyon: {{ etiket.aktiflestirme_tarihi|date:"d.m.Y" }}</span>
                                </div>
                                {% endif %}
                                {% if etiket.son_kullanma_tarihi %}
                                <div class="info-item">
                                    <i class="fas fa-clock"></i>
                                    <span style="color:{% if etiket.son_kullanma_tarihi < now %}#EB5757{% elif etiket.aktif %}#6FCF97{% else %}#b2bec3{% endif %}">
                                        Bitiş: {{ etiket.son_kullanma_tarihi|date:"d.m.Y" }}
                                        {% if etiket.son_kullanma_tarihi < now %}(Süresi Dolmuş){% elif etiket.aktif %}(Aktif){% endif %}
                                    </span>
                                </div>
                                {% endif %}
                            {% else %}
                                <p class="text-muted"><i class="fas fa-exclamation-triangle me-2"></i>Bu künye henüz bir evcil hayvana atanmamış.</p>
                            {% endif %}
                        </div>
                        <div class="pet-card-footer">
                            <div class="d-flex justify-content-between align-items-center gap-2">
                                {% if etiket.evcil_hayvan %}
                                    <a href="{% url 'anahtarlik:pet_detail' etiket.evcil_hayvan.id %}" class="btn btn-sm btn-outline-primary">
                                        <i class="fas fa-eye me-1"></i>Detay
                                    </a>
                                {% endif %}
                                {% if etiket.aktif %}
                                    {% if etiket.qr_kod_url %}
                                        <a href="{{ etiket.qr_kod_url }}" target="_blank" class="btn btn-sm btn-outline-success">
                                            <i class="fas fa-qrcode me-1"></i>QR Kod
                                        </a>
                                    {% endif %}
                                {% else %}
                                    <div class="d-flex gap-2">
                                        {% if etiket.son_kullanma_tarihi and etiket.son_kullanma_tarihi < now %}
                                            <a href="{% url 'etiket:etiket_yenileme_baslat' etiket.id %}" class="btn btn-sm btn-warning">
                                                <i class="fas fa-sync-alt me-1"></i>Yenile
                                            </a>
                                        {% else %}
                                            <a href="{% url 'etiket:etiket_yenileme_listesi' %}" class="btn btn-sm btn-success">
                                                <i class="fas fa-play me-1"></i>Aktifleştir
                                            </a>
                                        {% endif %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <i class="fas fa-qrcode"></i>
                <h4>Henüz künyeniz bulunmuyor</h4>
                <p>İlk evcil hayvanınızı ekleyerek künye sistemine katılın.</p>
                <a href="{% url 'anahtarlik:add_pet' %}" class="btn btn-primary">
                    <i class="fas fa-plus me-2"></i>İlk Evcil Hayvanımı Ekle
                </a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
